{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///Users/kurultai/molt/steppe-visualization/app/api/deliverables/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { promises as fs } from 'fs';\nimport path from 'path';\n\nexport const dynamic = 'force-static';\nexport const revalidate = 5;\n\nconst DELIVERABLES_PATH = process.env.DELIVERABLES_PATH || '/data/workspace/deliverables';\n\nexport async function GET() {\n  try {\n    // Check if directory exists\n    try {\n      await fs.access(DELIVERABLES_PATH);\n    } catch {\n      // Return empty array if path doesn't exist\n      return NextResponse.json({ files: [] });\n    }\n\n    // Read directory recursively\n    const files = await getAllFiles(DELIVERABLES_PATH);\n\n    return NextResponse.json({ files });\n  } catch (error) {\n    console.error('Error reading deliverables:', error);\n    return NextResponse.json(\n      { error: 'Failed to read deliverables' },\n      { status: 500 }\n    );\n  }\n}\n\nasync function getAllFiles(dir: string, basePath: string = ''): Promise<string[]> {\n  const files: string[] = [];\n\n  try {\n    const entries = await fs.readdir(dir, { withFileTypes: true });\n\n    for (const entry of entries) {\n      const fullPath = path.join(dir, entry.name);\n      const relativePath = path.join(basePath, entry.name);\n\n      if (entry.isDirectory()) {\n        const subFiles = await getAllFiles(fullPath, relativePath);\n        files.push(...subFiles);\n      } else {\n        files.push(relativePath);\n      }\n    }\n  } catch {\n    // Directory might not exist or be accessible\n  }\n\n  return files;\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;;;;AAEO,MAAM,UAAU;AAChB,MAAM,aAAa;AAE1B,MAAM,oBAAoB,QAAQ,GAAG,CAAC,iBAAiB,IAAI;AAEpD,eAAe;IACpB,IAAI;QACF,4BAA4B;QAC5B,IAAI;YACF,MAAM,yGAAE,CAAC,MAAM,CAAC;QAClB,EAAE,OAAM;YACN,2CAA2C;YAC3C,OAAO,mLAAY,CAAC,IAAI,CAAC;gBAAE,OAAO,EAAE;YAAC;QACvC;QAEA,6BAA6B;QAC7B,MAAM,QAAQ,MAAM,YAAY;QAEhC,OAAO,mLAAY,CAAC,IAAI,CAAC;YAAE;QAAM;IACnC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,OAAO,mLAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA8B,GACvC;YAAE,QAAQ;QAAI;IAElB;AACF;AAEA,eAAe,YAAY,GAAW,EAAE,WAAmB,EAAE;IAC3D,MAAM,QAAkB,EAAE;IAE1B,IAAI;QACF,MAAM,UAAU,MAAM,yGAAE,CAAC,OAAO,CAAC,KAAK;YAAE,eAAe;QAAK;QAE5D,KAAK,MAAM,SAAS,QAAS;YAC3B,MAAM,WAAW,4GAAI,CAAC,IAAI,CAAC,KAAK,MAAM,IAAI;YAC1C,MAAM,eAAe,4GAAI,CAAC,IAAI,CAAC,UAAU,MAAM,IAAI;YAEnD,IAAI,MAAM,WAAW,IAAI;gBACvB,MAAM,WAAW,MAAM,YAAY,UAAU;gBAC7C,MAAM,IAAI,IAAI;YAChB,OAAO;gBACL,MAAM,IAAI,CAAC;YACb;QACF;IACF,EAAE,OAAM;IACN,6CAA6C;IAC/C;IAEA,OAAO;AACT"}}]
}