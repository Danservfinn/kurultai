# Moltbot Railway Template - Deployment Configuration
# OpenClaw Gateway with built-in webchat UI
# https://docs.railway.com/deploy/config-as-code

[build]
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile"
watchPatterns = ["Dockerfile", "entrypoint.sh", "src/**", "routes/**", "middleware/**", "config/**", "package*.json"]

[build.args]
CACHE_BUST = "2026-02-08-v19-UNIFIED-HEARTBEAT"

[deploy]
# Health check - OpenClaw gateway health endpoint
healthcheckPath = "/health"
healthcheckTimeout = 120
healthcheckInterval = 30
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Resource allocation
numReplicas = 1

# Keep running
sleepApplication = false

# Cron schedules for background tasks
[[deploy.crons]]
name = "kurultai-heartbeat"
schedule = "*/5 * * * *"  # Every 5 minutes
command = "cd /app && python tools/kurultai/heartbeat_master.py --cycle"

[deploy.env]
# Signal Configuration
SIGNAL_ENABLED = "true"
SIGNAL_DATA_DIR = "/data/.signal"
SIGNAL_CLI_PATH = "/usr/local/bin/signal-cli"

# OpenClaw Gateway Configuration
NODE_ENV = "production"
OPENCLAW_GATEWAY_PORT = "18789"
OPENCLAW_STATE_DIR = "/data/.openclaw"
